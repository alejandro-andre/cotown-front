<app-spinner-control *ngIf="isLoading"></app-spinner-control>

<h1>{{ 'data' | translate }}</h1>

<h2>{{ 'personal_data' | translate }}</h2>
<div class="group">
  <div class="pure-g grid-container" >

    <div class="pure-u-1">
      <div class="label">{{ 'photo' | translate }}</div>
      <div class="image-container">
        <img *ngIf="customer.photo !== null" [src]="customer.photo?.thumbnail" [alt]="customer.photo?.name">
        <input id="photo" [(ngModel)]="image" type="file" (change)="upload($event)">
        <label *ngIf="!customer.photo || customer.photo === null" for="photo">Subir foto</label>
      </div>
    </div>      
    
    <div class="pure-u-1">

      <div class="pure-u-1 pure-u-lg-1-2">
        <mat-form-field>
          <mat-label>{{ 'name' | translate }}</mat-label>
          <input matInput [readonly]="visibility['name']" [(ngModel)]="customerService.customer.name" (change)="enableSave()">
        </mat-form-field>
      </div>

      <div class="pure-u-1-2 pure-u-lg-1-4">
        <mat-form-field *ngIf="!visibility['typeDoc']">
          <mat-label>{{ 'id_type' | translate }}</mat-label>
          <mat-select [(ngModel)]="customerService.customer.id_type_id" (selectionChange)="enableSave()">
            <mat-option *ngFor="let c of lookupService.idTypes" [value]="c.id">
              {{ isSpanish ? c.name : c.name_en  }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field *ngIf="visibility['typeDoc']">
          <mat-label>{{ 'id_type' | translate }}</mat-label>
          <input matInput readonly [ngModel]="idType">
        </mat-form-field>
      </div>

      <div class="pure-u-1-2 pure-u-lg-1-4">
        <mat-form-field>
          <mat-label>{{ 'document' | translate}}</mat-label>
          <input matInput [readonly]="visibility['document']" (change)="enableSave()" [(ngModel)]="customerService.customer.document">
        </mat-form-field>
      </div>
         
      <div class="pure-u-1 pure-u-lg-1-2">
        <mat-form-field>
          <mat-label>{{ 'email' | translate }}</mat-label>
          <input matInput readonly placeholder="{{'email' | translate}}" [(ngModel)]="customerService.customer.email">
        </mat-form-field>
      </div>
  
      <div class="pure-u-1 pure-u-lg-1-2">
        <mat-form-field>
          <mat-label>{{ 'phone' | translate }}</mat-label>
          <input matInput [readonly]="visibility['phone']" placeholder="{{'phone' | translate}}" 
                 [(ngModel)]="customerService.customer.phones" (change)="enableSave()">
        </mat-form-field>
      </div>
  
      <div class="pure-u-1 pure-u-lg-1-4">
        <mat-form-field>
          <mat-label>{{ 'language' | translate }}</mat-label>
          <mat-select [(ngModel)]="customerService.customer.appLang" (selectionChange)="changeLang()">
            <mat-option *ngFor="let c of lookupService.appLangs" [value]="c.id">
              {{ c.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

    </div>

  </div>
</div>

<h2>{{ 'address' | translate }}</h2>
<div class="group">
  <div class="pure-g">

    <div class="pure-u-1">
      <mat-form-field>
        <mat-label>{{ 'address' | translate }}</mat-label>
        <input matInput [readonly]="visibility['address']" placeholder="{{'address' | translate}}" 
               [(ngModel)]="customerService.customer.address" (change)="enableSave()">
      </mat-form-field>
    </div>

    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field>
        <mat-label>{{ 'zip' | translate }}</mat-label>
        <input matInput maxlength="5" [readonly]="visibility['zip']" placeholder="{{'zip' | translate}}" 
               [(ngModel)]="customerService.customer.zip" (change)="enableSave()" >
      </mat-form-field>
    </div>
    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field>
        <mat-label>{{ 'city' | translate }}</mat-label>
        <input matInput [readonly]="visibility['city']" placeholder="{{'city' | translate}}"
               [(ngModel)]="customerService.customer.city" (change)="enableSave()">
      </mat-form-field>
    </div>
    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field>
        <mat-label>{{ 'province' | translate }}</mat-label>
        <input matInput [readonly]="visibility['province']" placeholder="{{'province' | translate}}"
               [(ngModel)]="customerService.customer.province" (change)="enableSave()">
      </mat-form-field>
    </div>
    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field *ngIf="visibility['country']">
        <mat-label>{{ 'country' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'country' | translate }}" [ngModel]="country">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['country']">
        <mat-label>{{ 'country' | translate }}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.country_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.countries" [value]="c.id">
            {{ isSpanish ? c.name : c.name_en }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

  </div>
</div>

<h2>{{ 'age' | translate }}</h2>
<div class="group">
  <div class="pure-g">

    <div class="pure-u-1-2 pure-u-lg-1-4">
        <mat-form-field *ngIf="visibility['birthDate']">
          <mat-label>{{ 'birth_date' | translate }}</mat-label>
          <input matInput readonly placeholder="{{ 'birth_date' | translate }}" [ngModel]="birthDate">
        </mat-form-field>
        <mat-form-field *ngIf="!visibility['birthDate']">
          <mat-label>{{ 'birth_date' | translate }}</mat-label>
          <input matInput [matDatepicker]="picker" [formControl]="birthDateControl" (dateInput)="enableSave()">
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
    </div>

  </div>
</div>

<h2>{{ 'other' | translate }}</h2>
<div class="group">
  <div class="pure-g">

    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field *ngIf="visibility['genderId']">
        <mat-label>{{ 'gender' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'gender' | translate }}" [ngModel]="gender">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['genderId']">
        <mat-label>{{ 'gender' | translate }}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.gender_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.genders" [value]="c.id">
            {{ isSpanish ? c.name : c.name_en  }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field *ngIf="visibility['languageId']">
        <mat-label>{{ 'language' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'language' | translate }}" [ngModel]="language">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['languageId']">
        <mat-label>{{ 'language' | translate }}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.language_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.languages" [value]="c.id">
            {{ isSpanish ? c.name : c.name_en }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field *ngIf="visibility['nationality']">
        <mat-label>{{ 'nationality' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'nationality' | translate }}" [ngModel]="nationality">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['nationality']">
        <mat-label>{{ 'nationality' | translate}}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.nationality_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.countries" [value]="c.id">
            {{ isSpanish ? c.name : c.name_en }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="pure-u-1-2 pure-u-lg-1-4">
      <mat-form-field *ngIf="visibility['originId']">
        <mat-label>{{ 'country_origin' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'country_origin' | translate }}" [ngModel]="origin">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['originId']">
        <mat-label>{{ 'country_origin' | translate }}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.country_origin_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.countries" [value]="c.id">
            {{ isSpanish ? c.name : c.name_en }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="pure-u-1 pure-u-lg-1-2">     
      <mat-form-field *ngIf="visibility['schoolOrCompany']">
        <mat-label>{{ 'school' | translate }}</mat-label>
        <input matInput readonly placeholder="{{ 'school' | translate }}" [ngModel]="school">
      </mat-form-field>
      <mat-form-field *ngIf="!visibility['schoolOrCompany']">
        <mat-label>{{ 'school' | translate }}</mat-label>
        <mat-select [(ngModel)]="customerService.customer.school_id" (selectionChange)="enableSave()">
          <mat-option *ngFor="let c of lookupService.schools" [value]="c.id">
            {{ c.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="pure-u-1 pure-u-lg-1-2">     
      <mat-form-field>
        <mat-label>{{ 'bank_account' | translate }}</mat-label>
        <input matInput [readonly]="visibility['bankAcount']" placeholder="{{'bank_account' | translate}}"
               [(ngModel)]="customerService.customer.bank_account" (change)="enableSave()">
      </mat-form-field>
    </div>

  </div>

</div>

<div class="pure-u-1">
  <button class="action" [disabled]="!isSaveEnabled" mat-raised-button color="primary" (click)="save()">
    {{ 'save' | translate }}
  </button>
</div>